<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeVengers|Lack of Coordination Between Local and Fedral goverment </title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Noto+Sans+Devanagari:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Background Pattern -->
    <div class="bg-pattern"></div>
    
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen hidden">
            <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h2 style="color: white; margin-bottom: 1rem;" data-i18n="loading_title">Nepal e-Governance</h2>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p style="color: rgba(255,255,255,0.7); margin-top: 1rem;" data-i18n="loading_message">Loading your services...</p>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="successToast" class="toast hidden">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage" data-i18n="toast_success">Success!</span>
    </div>

    <!-- Profile Setup Modal -->
    <div id="profileSetupModal" class="modal hidden">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-user-circle"></i> <span data-i18n="profile_complete">Complete Your Profile</span></h2>
                <button class="close-btn" onclick="closeProfileSetup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="profile-setup-content">
                <div class="profile-setup-step active" data-step="1">
                    <h3 data-i18n="profile_personal">Personal Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="profile_full_name_en">Full Name (English) *</label>
                            <input type="text" id="fullNameEn" class="form-input" placeholder="Ram Bahadur Thapa">
                        </div>
                        <div class="form-group">
                            <label data-i18n="profile_full_name_np">‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ (‡§®‡•á‡§™‡§æ‡§≤‡•Ä) *</label>
                            <input type="text" id="fullNameNp" class="form-input" placeholder="‡§∞‡§æ‡§Æ ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§•‡§æ‡§™‡§æ">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="profile_dob">Date of Birth *</label>
                            <input type="date" id="dob" class="form-input">
                        </div>
                        <div class="form-group">
                            <label data-i18n="profile_gender">Gender *</label>
                            <select id="gender" class="form-input">
                                <option value="">Select</option>
                                <option value="male">Male / ‡§™‡•Å‡§∞‡•Å‡§∑</option>
                                <option value="female">Female / ‡§Æ‡§π‡§ø‡§≤‡§æ</option>
                                <option value="other">Other / ‡§Ö‡§®‡•ç‡§Ø</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="profile_blood">Blood Group</label>
                            <select id="bloodGroup" class="form-input">
                                <option value="">Select</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label data-i18n="profile_mobile">Mobile Number *</label>
                            <input type="tel" id="mobile" class="form-input" placeholder="+977 98XXXXXXXX">
                        </div>
                    </div>
                </div>

                <div class="profile-setup-step" data-step="2">
                    <h3 data-i18n="profile_photo">Upload Profile Picture</h3>
                    <div class="profile-photo-upload">
                        <div class="photo-preview" id="photoPreview">
                            <i class="fas fa-user"></i>
                        </div>
                        <input type="file" id="profilePhoto" accept="image/*" style="display: none;">
                        <button class="btn-primary" onclick="document.getElementById('profilePhoto').click()">
                            <i class="fas fa-camera"></i> <span data-i18n="choose_photo">Choose Photo</span>
                        </button>
                        <button class="btn-secondary" onclick="capturePhoto()">
                            <i class="fas fa-video"></i> <span data-i18n="use_camera">Use Camera</span>
                        </button>
                    </div>
                </div>

                <div class="profile-setup-step" data-step="3">
                    <h3 data-i18n="profile_address">Address Information</h3>
                    <div class="form-group">
                        <label data-i18n="profile_province">Province *</label>
                        <select id="province" class="form-input" onchange="loadDistricts()">
                            <option value="">Select Province</option>
                            <option value="1">Koshi Pradesh</option>
                            <option value="2">Madhesh Pradesh</option>
                            <option value="3">Bagmati Pradesh</option>
                            <option value="4">Gandaki Pradesh</option>
                            <option value="5">Lumbini Pradesh</option>
                            <option value="6">Karnali Pradesh</option>
                            <option value="7">Sudurpashchim Pradesh</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label data-i18n="profile_district">District *</label>
                            <select id="district" class="form-input" onchange="loadMunicipalities()">
                                <option value="">Select District</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Municipality *</label>
                            <select id="municipality" class="form-input">
                                <option value="">Select Municipality</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ward No. *</label>
                            <input type="number" id="ward" class="form-input" min="1" placeholder="1-33">
                        </div>
                        <div class="form-group">
                            <label>Tole/Street</label>
                            <input type="text" id="tole" class="form-input" placeholder="Enter tole name">
                        </div>
                    </div>
                </div>

                <div class="profile-setup-step" data-step="4">
                    <h3>Identity Documents</h3>
                    <div class="form-group">
                        <label>Citizenship Number</label>
                        <input type="text" id="citizenshipNo" class="form-input" placeholder="1234-5678-9012">
                    </div>
                    <div class="form-group">
                        <label>Passport Number (if available)</label>
                        <input type="text" id="passportNo" class="form-input" placeholder="12345678">
                    </div>
                    <div class="form-group">
                        <label>National ID Number</label>
                        <input type="text" id="nationalId" class="form-input" placeholder="Generated automatically" disabled>
                    </div>
                    <div class="security-notice">
                        <i class="fas fa-shield-alt"></i>
                        <p data-i18n="security_notice">All your personal data is encrypted and stored securely using blockchain technology.</p>
                    </div>
                </div>

                <div class="profile-setup-navigation">
                    <button class="btn-secondary" id="prevBtn" onclick="previousStep()" disabled>
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <div class="step-indicators">
                        <span class="step-dot active" data-step="1"></span>
                        <span class="step-dot" data-step="2"></span>
                        <span class="step-dot" data-step="3"></span>
                        <span class="step-dot" data-step="4"></span>
                    </div>
                    <button class="btn-primary" id="nextBtn" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <div class="header-left">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo-section">
                    <div class="logo-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="logo-text">
                        <h1 data-i18n="app_name">Smart Nepal</h1>
                        <p data-i18n="app_subtitle">Nepal e-Governance</p>
                    </div>
                </div>
            </div>
            
            <div class="header-center">
                <div class="search-header">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search services, documents..." id="globalSearch" data-i18n-placeholder="header_search">
                </div>
            </div>

            <div class="header-right">
                <button class="icon-btn" onclick="toggleTheme()" title="Toggle Theme">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <button class="icon-btn" onclick="toggleNotifications()" title="Notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationCount">3</span>
                </button>
                <button class="icon-btn" onclick="toggleTopLanguage()" title="Toggle Language" id="langToggle" style="position: relative;">
                    <i class="fas fa-language"></i>
                    <span id="currentLanguage" style="position: absolute; right: 0.25rem; bottom: 0.25rem; font-weight: 700; font-size: 0.7rem; background: var(--primary-blue); color: white; width: 1rem; height: 1rem; border-radius: 50%; display: flex; align-items: center; justify-content: center;">EN</span>
                </button>
                <div class="user-profile-btn" onclick="toggleUserMenu()">
                    <div class="user-avatar" id="headerAvatar">NP</div>
                    <div class="user-info">
                        <span id="headerUserName">Guest User</span>
                        <small id="headerUserRole">Citizen</small>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>

        <!-- User Menu Dropdown -->
        <div id="userMenu" class="dropdown-menu hidden">
            <div class="dropdown-header">
                <div class="menu-avatar" id="menuAvatar">NP</div>
                <div>
                    <h4 id="menuUserName">Guest User</h4>
                    <p id="menuUserEmail">guest@nagarik.gov.np</p>
                </div>
            </div>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item" onclick="showTab('profile')">
                <i class="fas fa-user"></i> <span data-i18n="header_profile">My Profile</span>
            </button>
            <button class="dropdown-item" onclick="showTab('settings')">
                <i class="fas fa-cog"></i> <span data-i18n="header_settings">Settings</span>
            </button>
            <button class="dropdown-item" onclick="showTab('security')">
                <i class="fas fa-shield-alt"></i> <span data-i18n="header_security">Security & Privacy</span>
            </button>
            <button class="dropdown-item" onclick="generateQR()">
                <i class="fas fa-qrcode"></i> Generate QR Code
            </button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item" onclick="contactSupport()">
                <i class="fas fa-question-circle"></i> <span data-i18n="header_help">Help & Support</span>
            </button>
            <button class="dropdown-item text-danger" onclick="window.location.href='index.html'">
                <i class="fas fa-sign-out-alt"></i> <span data-i18n="header_logout">Logout</span>
            </button>
        </div>

        <!-- Notifications Dropdown -->
        <div id="notificationsPanel" class="dropdown-menu notifications-panel hidden">
                <div class="dropdown-header">
                <h3><i class="fas fa-bell"></i> <span data-i18n="notifications_title">Notifications</span></h3>
                <button class="btn-text" onclick="markAllRead()" data-i18n="notif_all">Mark all read</button>
            </div>
            <div class="notifications-list" id="notificationsList">
                <!-- Notifications populated by JS -->
            </div>
            <div class="dropdown-footer">
                <button class="btn-text" onclick="showTab('notifications')" data-i18n="view_all">View All Notifications</button>
            </div>
        </div>

        <!-- Language Selector -->
        <div id="languageSelector" class="dropdown-menu hidden">
            <div class="dropdown-header">
                <h4><i class="fas fa-language"></i> <span data-i18n="header_language">Change Language</span></h4>
            </div>
            <button class="dropdown-item" onclick="changeAppLanguage('english')">
                <i class="fas fa-circle-half-stroke"></i> <span data-i18n="lang_english">English</span>
            </button>
            <button class="dropdown-item" onclick="changeAppLanguage('nepali')">
                <i class="fas fa-circle-half-stroke"></i> <span data-i18n="lang_nepali">‡§®‡•á‡§™‡§æ‡§≤‡•Ä (Nepali)</span>
            </button>
        </div>
    </header>

    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="showTab('dashboard')">
                    <i class="fas fa-home"></i>
                    <span data-i18n="sidebar_dashboard">Dashboard</span>
                </button>
                <button class="nav-btn" onclick="showTab('ai-assistant')">
                    <i class="fas fa-robot"></i>
                    <span data-i18n="sidebar_ai">AI Assistant</span>
                </button>
                <button class="nav-btn" onclick="showTab('services')">
                    <i class="fas fa-briefcase"></i>
                    <span data-i18n="sidebar_services">All Services</span>
                </button>
                <button class="nav-btn" onclick="showTab('news')">
                    <i class="fas fa-newspaper"></i>
                    <span>Government News</span>
                </button>
                <button class="nav-btn" onclick="showTab('applications')">
                    <i class="fas fa-file-alt"></i>
                    <span data-i18n="sidebar_applications">My Applications</span>
                </button>
                <button class="nav-btn" onclick="showTab('profile')">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </button>
                <button class="nav-btn" onclick="showTab('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </button>
            </nav>

            <div class="sidebar-section">
                <h4><i class="fas fa-star"></i> Quick Actions</h4>
                <button class="quick-action-btn" onclick="quickApply('citizenship')">
                    <i class="fas fa-id-card"></i> <span data-i18n="quick_apply_citizenship">Apply Citizenship</span>
                </button>
                <button class="quick-action-btn" onclick="quickApply('passport')">
                    <i class="fas fa-passport"></i> <span data-i18n="quick_apply_passport">Renew Passport</span>
                </button>
                <button class="quick-action-btn" onclick="quickPay()">
                    <i class="fas fa-bolt"></i> <span data-i18n="quick_apply_payments">Pay Bills</span>
                </button>
            </div>

            <div class="contact-card">
                <h4><i class="fas fa-phone"></i> Emergency Contact</h4>
                <a href="tel:100" class="contact-item">
                    <div class="contact-icon red">
                        <i class="fas fa-phone"></i>
                    </div>
                    <div>
                        <span data-i18n="contact_police">Police</span>
                        <strong>100</strong>
                    </div>
                </a>
                <a href="tel:1660-01-55555" class="contact-item">
                    <div class="contact-icon blue">
                        <i class="fas fa-headset"></i>
                    </div>
                    <div>
                        <span data-i18n="contact_support">Support</span>
                        <strong>1660-01-55555</strong>
                    </div>
                </a>
            </div>

            <div class="sidebar-footer">
                <p data-i18n="footer_version">Version 3.0.0</p>
                <p data-i18n="footer_copyright">¬© 2025 Nepal Government</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="page-header">
                    <div>
                        <h2 class="page-title"><span data-i18n="dashboard_welcome">Welcome back, Citizen!</span></h2>
                        <p class="page-subtitle" data-i18n="dashboard_subtitle">Here's what's happening with your services today</p>
                    </div>
                    <button class="btn-primary" onclick="showTab('ai-assistant')" data-i18n="dashboard_ask_ai">
                        <i class="fas fa-robot"></i> <span data-i18n="dashboard_ask_ai">Ask AI Assistant</span>
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="stats-grid">
                    <div class="stat-card blue gradient-card">
                        <div class="stat-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 class="counter" data-target="4">0</h3>
                            <p>My Applications</p>
                            <small class="trend pending"><i class="fas fa-clock"></i> 2 pending review</small>
                        </div>
                    </div>
                    <div class="stat-card green gradient-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 class="counter" data-target="8">0</h3>
                            <p>Completed Services</p>
                            <small class="trend"><i class="fas fa-arrow-up"></i> This month</small>
                        </div>
                    </div>
                    <div class="stat-card purple gradient-card">
                        <div class="stat-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="stat-info">
                            <h3 class="counter" data-target="5">0</h3>
                            <p>New Notifications</p>
                            <small class="trend"><i class="fas fa-info-circle"></i> Updates available</small>
                        </div>
                    </div>
                    <div class="stat-card orange gradient-card">
                        <div class="stat-icon">
                            <i class="fas fa-newspaper"></i>
                        </div>
                        <div class="stat-info">
                            <h3 class="counter" data-target="12">0</h3>
                            <p>Government Updates</p>
                            <small class="trend"><i class="fas fa-eye"></i> Unread news</small>
                        </div>
                    </div>
                </div>

                <!-- Action Cards Grid -->
                <div class="action-cards-grid">
                    <div class="action-card apply-services">
                        <div class="action-card-header">
                            <h3 data-i18n="dashboard_apply">Apply for Services</h3>
                            <i class="fas fa-rocket"></i>
                        </div>
                        <p data-i18n="dashboard_apply_desc">Quick access to 120+ government services</p>
                        <div class="action-buttons">
                            <button onclick="showTab('services')" data-i18n="dashboard_browse">Browse Services</button>
                            <button onclick="showTab('ai-assistant')" class="secondary" data-i18n="dashboard_ask_ai">Ask AI</button>
                        </div>
                    </div>

                    <div class="action-card track-status">
                        <div class="action-card-header">
                            <h3 data-i18n="dashboard_track">Track Applications</h3>
                            <i class="fas fa-search"></i>
                        </div>
                        <p data-i18n="dashboard_track_desc">Real-time status of your applications</p>
                        <div class="quick-track">
                            <input type="text" placeholder="Enter application ID..." class="track-input">
                            <button onclick="trackApplication()"><i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <div class="action-card coordination-status">
                        <div class="action-card-header">
                            <h3>Coordination Status</h3>
                            <i class="fas fa-network-wired"></i>
                        </div>
                        <p>Track coordination between local and federal government</p>
                        <div class="coordination-summary">
                            <div class="coordination-item">
                                <span><i class="fas fa-check-circle" style="color: #10b981;"></i> Requests Synced</span>
                                <strong>12</strong>
                            </div>
                            <div class="coordination-item">
                                <span><i class="fas fa-clock" style="color: #f59e0b;"></i> In Progress</span>
                                <strong>3</strong>
                            </div>
                        </div>
                        <button onclick="showTab('news')" class="btn-primary">View Updates</button>
                    </div>
                </div>

                <!-- Recent Activity & Notifications Row -->
                <div class="dashboard-row">
                        <div class="card activity-card">
                        <div class="card-header">
                                <h3><i class="fas fa-clock"></i> <span data-i18n="dashboard_recent">Recent Activity</span></h3>
                            <button class="btn-text" onclick="showTab('applications')" data-i18n="view_all">View All</button>
                        </div>
                        <div class="activity-timeline" id="recentActivity">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                        <div class="card notifications-card">
                        <div class="card-header">
                                <h3><i class="fas fa-bell"></i> <span data-i18n="dashboard_notices">Important Notices</span></h3>
                            <button class="btn-text" onclick="showTab('notifications')" data-i18n="view_all">View All</button>
                        </div>
                        <div class="notices-list" id="importantNotices">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Services Shortcuts -->
                    <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-bolt"></i> <span data-i18n="dashboard_popular">Popular Services</span></h3>
                    </div>
                    <div class="services-shortcuts" id="popularServices">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- AI Assistant Tab -->
            <div id="ai-assistant-tab" class="tab-content">
                <div class="ai-container">
                    <div class="ai-sidebar">
                            <h3 data-i18n="chat_history">Chat History</h3>
                            <button class="new-chat-btn" onclick="newChat()">
                                <i class="fas fa-plus"></i> <span data-i18n="new_chat">New Chat</span>
                            </button>
                        <div class="chat-history-list" id="chatHistory">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <div class="ai-main">
                        <div class="ai-header-enhanced">
                            <div class="ai-icon-large">
                                <i class="fas fa-robot"></i>
                            </div>
                                <div class="ai-title-section">
                                <h2 data-i18n="ai_title">AI-Powered Service Assistant</h2>
                                <p data-i18n="ai_subtitle">‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§æ‡§® ‡§∏‡§π‡§æ‡§Ø‡§ï - Ask anything about government services</p>
                            </div>
                            <div class="ai-actions">
                                <button class="icon-btn" onclick="toggleVoiceMode()" title="Voice Mode">
                                    <i class="fas fa-microphone"></i>
                                </button>
                                <button class="icon-btn" onclick="shareChat()" title="Share Chat">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                                <button class="icon-btn" onclick="clearChat()" title="Clear Chat">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>

                        <div class="ai-features-bar">
                            <div class="feature-chip">
                                <i class="fas fa-clock"></i> 24/7 Available
                            </div>
                            <div class="feature-chip">
                                <i class="fas fa-language"></i> Bilingual
                            </div>
                            <div class="feature-chip">
                                <i class="fas fa-shield-alt"></i> Secure
                            </div>
                            <div class="feature-chip">
                                <i class="fas fa-brain"></i> AI-Powered
                            </div>
                        </div>

                        <div class="chat-container-enhanced">
                            <div class="chat-messages-enhanced" id="chatMessages">
                                <div class="chat-welcome">
                                    <div class="welcome-icon">
                                        <i class="fas fa-hands-helping"></i>
                                    </div>
                                    <h3>Namaste! üôè How can I help you today?</h3>
                                    <p>I can assist you with citizenship, passport, licenses, and all government services</p>
                                    
                                    <div class="suggested-prompts">
                                        <button class="prompt-chip" onclick="sendPrompt('How do I apply for citizenship?')">
                                            üìù <span data-i18n="ai_citizenship">Apply for Citizenship</span>
                                        </button>
                                        <button class="prompt-chip" onclick="sendPrompt('Track my passport application')">
                                            üîç <span data-i18n="ai_passport">Track Passport</span>
                                        </button>
                                        <button class="prompt-chip" onclick="sendPrompt('How to pay bills online?')">
                                            üí≥ <span data-i18n="ai_bills">Pay Bills</span>
                                        </button>
                                        <button class="prompt-chip" onclick="sendPrompt('‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§ï‡§∏‡§∞‡•Ä ‡§Ü‡§µ‡•á‡§¶‡§® ‡§¶‡§ø‡§®‡•á?')">
                                            üá≥üáµ <span data-i18n="ai_nepali">‡§®‡•á‡§™‡§æ‡§≤‡•Ä‡§Æ‡§æ ‡§∏‡•ã‡§ß‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="chat-input-container-enhanced">
                                    <div class="input-wrapper">
                                    <button class="input-action-btn" onclick="attachFile()" title="Attach File">
                                        <i class="fas fa-paperclip"></i>
                                    </button>
                                    <input 
                                        type="text" 
                                        id="userInput" 
                                        class="chat-input-enhanced" 
                                            data-i18n-placeholder="ai_placeholder"
                                    />
                                    <button class="input-action-btn voice-btn-enhanced" onclick="startVoiceRecognition()" id="voiceBtn">
                                        <i class="fas fa-microphone"></i>
                                    </button>
                                    <button class="send-btn-enhanced" onclick="sendMessage()">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                                <div class="input-footer">
                                    <span class="input-tip">
                                        <i class="fas fa-lightbulb"></i>
                                        <span data-i18n="input_tip">Press Enter to send</span>
                                    </span>
                                    <span class="ai-status">
                                        <span class="status-dot"></span> <span data-i18n="ai_status_ready">AI Ready</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ALL 120+ SERVICES TAB -->
            <div id="services-tab" class="tab-content">
                <div class="page-header">
                    <div>
                        <h2 class="page-title"><i class="fas fa-briefcase"></i> All Government Services</h2>
                        <p class="page-subtitle">Access 120+ government services in one place</p>
                    </div>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="serviceSearch" placeholder="Search services..." onkeyup="filterServices()">
                    </div>
                </div>
                <div class="services-category-tabs">
                    <button class="category-tab active" onclick="filterByCategory('all')">All</button>
                    <button class="category-tab" onclick="filterByCategory('citizenship')">Citizenship</button>
                    <button class="category-tab" onclick="filterByCategory('passport')">Passport</button>
                    <button class="category-tab" onclick="filterByCategory('documents')">Documents</button>
                    <button class="category-tab" onclick="filterByCategory('licenses')">Licenses</button>
                    <button class="category-tab" onclick="filterByCategory('payments')">Payments</button>
                    <button class="category-tab" onclick="filterByCategory('utilities')">Utilities</button>
                </div>
                <div class="services-grid" id="servicesGrid">
                    <!-- Services will be populated by JavaScript -->
                </div>
            </div>

            <!-- NEWS PORTAL TAB -->
            <div id="news-tab" class="tab-content">
                <div class="page-header">
                    <div>
                        <h2 class="page-title"><i class="fas fa-newspaper"></i> Government News Portal</h2>
                        <p class="page-subtitle">Stay updated with local and federal government changes</p>
                    </div>
                    <div class="news-filter-tabs">
                        <button class="filter-btn active" onclick="filterNews('all')">All News</button>
                        <button class="filter-btn" onclick="filterNews('federal')">Federal</button>
                        <button class="filter-btn" onclick="filterNews('provincial')">Provincial</button>
                        <button class="filter-btn" onclick="filterNews('local')">Local</button>
                    </div>
                </div>

                <div class="news-container">
                    <div class="news-main-section">
                        <div class="featured-news-card" id="featuredNews">
                            <!-- Featured news will be populated by JS -->
                        </div>

                        <div class="news-grid" id="newsGrid">
                            <!-- News items will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="news-sidebar">
                        <div class="news-widget">
                            <h3><i class="fas fa-fire"></i> Trending Updates</h3>
                            <div class="trending-list" id="trendingNews">
                                <!-- Trending news -->
                            </div>
                        </div>

                        <div class="news-widget">
                            <h3><i class="fas fa-bullhorn"></i> Policy Changes</h3>
                            <div class="policy-list" id="policyChanges">
                                <!-- Policy changes -->
                            </div>
                        </div>

                        <div class="news-widget">
                            <h3><i class="fas fa-calendar-alt"></i> Upcoming Events</h3>
                            <div class="events-list" id="upcomingEvents">
                                <!-- Events -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DOCUMENTS TAB -->
            <div id="documents-tab" class="tab-content">
                <!-- Will be populated by JavaScript with all documents -->
            </div>

            <!-- Profile Tab -->
            <div id="profile-tab" class="tab-content">
                <div class="profile-container">
                    <div class="profile-header-banner">
                        <button class="edit-banner-btn" onclick="editBanner()">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <div class="profile-main">
                        <div class="profile-sidebar-section">
                            <div class="profile-photo-section">
                                <div class="profile-photo-large" id="profilePhotoLarge">
                                    <i class="fas fa-user"></i>
                                </div>
                                <button class="edit-photo-btn" onclick="editProfilePhoto()">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                            <h2 id="profileFullName">Guest User</h2>
                            <p class="profile-id">ID: <strong id="profileNationalId">NP-xxxx-xxxx</strong></p>
                            <div class="profile-stats-mini">
                                <div>
                                    <strong>4</strong>
                                    <span>Applications</span>
                                </div>
                                <div>
                                    <strong>12</strong>
                                    <span>Documents</span>
                                </div>
                                <div>
                                    <strong>98%</strong>
                                    <span>Verified</span>
                                </div>
                            </div>
                            <button class="btn-primary full-width" onclick="generateQR()">
                                <i class="fas fa-qrcode"></i> Generate QR Code
                            </button>
                        </div>

                        <div class="profile-content-section">
                                <div class="profile-tabs">
                                <button class="profile-tab-btn active" onclick="showProfileTab('personal')" data-i18n="profile_tab_personal">
                                    Personal Info
                                </button>
                                <button class="profile-tab-btn" onclick="showProfileTab('contact')" data-i18n="profile_tab_contact">
                                    Contact
                                </button>
                                <button class="profile-tab-btn" onclick="showProfileTab('documents')" data-i18n="profile_tab_documents">
                                    Documents
                                </button>
                                <button class="profile-tab-btn" onclick="showProfileTab('activity')" data-i18n="profile_tab_activity">
                                    Activity Log
                                </button>
                            </div>

                            <div class="profile-tab-content active" id="profile-personal-tab">
                                <div class="info-section">
                                    <div class="section-header">
                                        <h3 data-i18n="profile_personal">Basic Information</h3>
                                        <button class="btn-secondary" onclick="editProfile()">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <label>Full Name</label>
                                            <p id="infoFullName">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>‡§®‡•á‡§™‡§æ‡§≤‡•Ä ‡§®‡§æ‡§Æ</label>
                                            <p id="infoFullNameNp">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Date of Birth</label>
                                            <p id="infoDob">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Gender</label>
                                            <p id="infoGender">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Blood Group</label>
                                            <p id="infoBloodGroup">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Citizenship No.</label>
                                            <p id="infoCitizenship">-</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="info-section">
                                    <div class="section-header">
                                        <h3 data-i18n="profile_address">Address Information</h3>
                                        <button class="btn-secondary" onclick="editAddress()">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                    </div>
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <label>Province</label>
                                            <p id="infoProvince">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>District</label>
                                            <p id="infoDistrict">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Municipality</label>
                                            <p id="infoMunicipality">-</p>
                                        </div>
                                        <div class="info-item">
                                            <label>Ward No.</label>
                                            <p id="infoWard">-</p>
                                        </div>
                                        <div class="info-item full-width">
                                            <label>Complete Address</label>
                                            <p id="infoFullAddress">-</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <h2 class="page-title"><i class="fas fa-cog"></i> <span data-i18n="settings_title">Settings</span></h2>
                
                <div class="settings-container">
                    <div class="settings-sidebar">
                        <button class="settings-nav-btn active" data-section="general">
                            <i class="fas fa-sliders-h"></i> General
                        </button>
                        <button class="settings-nav-btn" data-section="appearance">
                            <i class="fas fa-palette"></i> Appearance
                        </button>
                        <button class="settings-nav-btn" data-section="notifications">
                            <i class="fas fa-bell"></i> <span data-i18n="settings_notifications">Notifications</span>
                        </button>
                        <button class="settings-nav-btn" data-section="privacy">
                            <i class="fas fa-shield-alt"></i> Privacy
                        </button>
                        <button class="settings-nav-btn" data-section="security">
                            <i class="fas fa-lock"></i> Security
                        </button>
                    </div>

                    <div class="settings-content">
                        <!-- General Settings -->
                        <div class="settings-section active" id="general-settings">
                            <h3 data-i18n="general_settings">General Settings</h3>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Auto-save Forms</label>
                                    <p>Automatically save form progress</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="autoSave" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>

                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Remember Login</label>
                                    <p>Stay logged in on this device</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="rememberLogin" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Other settings sections -->
                        <div class="settings-section" id="appearance-settings">
                            <h3>Appearance</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Theme</label>
                                    <p>Choose your preferred theme</p>
                                </div>
                                <div class="theme-selector">
                                    <button class="theme-btn active" onclick="toggleTheme()">
                                        <i class="fas fa-sun"></i> Light
                                    </button>
                                    <button class="theme-btn" onclick="toggleTheme()">
                                        <i class="fas fa-moon"></i> Dark
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="settings-section" id="notifications-settings">
                            <h3>Notification Preferences</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Push Notifications</label>
                                    <p>Receive alerts for important updates</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="settings-section" id="privacy-settings">
                            <h3>Privacy & Data</h3>
                            <div class="privacy-actions">
                                <button class="btn-secondary" onclick="downloadMyData()">
                                    <i class="fas fa-download"></i> Download My Data
                                </button>
                                <button class="btn-secondary" onclick="requestDataDeletion()">
                                    <i class="fas fa-trash"></i> Request Data Deletion
                                </button>
                            </div>
                        </div>

                        <div class="settings-section" id="security-settings">
                            <h3 data-i18n="settings_security">Security Settings</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Two-Factor Authentication</label>
                                    <p>Add extra security to your account</p>
                                </div>
                                <button class="btn-primary" onclick="setup2FA()">
                                    <i class="fas fa-shield-alt"></i> Enable 2FA
                                </button>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <label>Biometric Login</label>
                                    <p>Use fingerprint or face ID to login</p>
                                </div>
                                <button class="btn-primary" onclick="setupBiometric()">
                                    <i class="fas fa-fingerprint"></i> Setup Biometric
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- My Applications Tab -->
            <div id="applications-tab" class="tab-content">
                <div class="page-header">
                    <div>
                        <h2 class="page-title"><i class="fas fa-file-alt"></i> My Applications</h2>
                        <p class="page-subtitle">Track and manage all your government service applications</p>
                    </div>
                    <button class="btn-primary" onclick="showTab('services')">
                        <i class="fas fa-plus"></i> New Application
                    </button>
                </div>

                <div class="applications-filter">
                    <button class="filter-btn active" onclick="filterApplications('all')">All</button>
                    <button class="filter-btn" onclick="filterApplications('pending')">Pending</button>
                    <button class="filter-btn" onclick="filterApplications('approved')">Approved</button>
                    <button class="filter-btn" onclick="filterApplications('rejected')">Rejected</button>
                    <button class="filter-btn" onclick="filterApplications('completed')">Completed</button>
                </div>

                <div class="applications-list" id="applicationsList">
                    <!-- Applications will be populated by JavaScript -->
                </div>
            </div>

        </main>
    </div>

    <!-- Language Modal -->
    <div id="languageModal" class="modal hidden">
                <div class="modal-content">
            <h3 data-i18n="language_modal_title">Choose Response Language</h3>
            <p class="modal-subtitle" data-i18n="language_modal_subtitle">‡§≠‡§æ‡§∑‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç / Select Language</p>
            <div class="language-options">
                <button class="language-btn blue" onclick="selectLanguage('english')">
                    <i class="fas fa-flag"></i>
                    <span>English</span>
                </button>
                <button class="language-btn red" onclick="selectLanguage('nepali')">
                    <i class="fas fa-flag"></i>
                    <span>‡§®‡•á‡§™‡§æ‡§≤‡•Ä</span>
                </button>
            </div>
            <button class="btn-secondary full-width" onclick="closeLanguageModal()">Cancel</button>
        </div>
    </div>

    <!-- Camera Modal for Profile Photo --> 
    <div id="cameraModal" class="modal hidden">
                <div class="modal-content large">
            <div class="modal-header">
                <h3><i class="fas fa-camera"></i> <span data-i18n="camera_title">Capture Photo</span></h3>
                <button class="close-btn" onclick="closeCameraModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="camera-container">
                <video id="cameraVideo" autoplay playsinline></video>
                <canvas id="cameraCanvas" style="display: none;"></canvas>
                <div class="camera-controls">
                                <button class="btn-primary" onclick="capturePhotoNow()">
                        <i class="fas fa-camera"></i> <span data-i18n="camera_capture">Capture</span>
                    </button>
                    <button class="btn-secondary" onclick="closeCameraModal()">
                        <span data-i18n="camera_cancel">Cancel</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- background music -->
    <audio id="bg-music" autoplay >
    <source src="back.mp3" type="audio/mpeg">
  </audio>

  <script>
  
    document.addEventListener("click", () => {
      setTimeout(() => {
        const music = document.getElementById("bg-music");
        music.muted = false; // unmute after delay
        music.play().catch(err => {
          console.log("Playback failed:", err);
        });
      }, 1000); 
    }, { once: true }); 
  </script>
    <script src="languages.js"></script>
    <script src="app.js"></script>
    
    <!-- Enhanced Citizen Portal Scripts -->
    <script>
        // News Portal Data and Functions
        const newsData = {
            federal: [
                {
                    id: 1,
                    title: "New Digital Citizenship Card Rollout",
                    summary: "Federal government announces nationwide rollout of digital citizenship cards with blockchain security.",
                    content: "The Ministry of Home Affairs has launched a comprehensive digital citizenship program that will replace traditional paper cards. The new system uses blockchain technology to ensure security and prevent fraud.",
                    date: "2025-01-15",
                    category: "federal",
                    priority: "high",
                    image: "https://via.placeholder.com/400x250?text=Federal+Update",
                    tags: ["Citizenship", "Digital", "Security"]
                },
                {
                    id: 2,
                    title: "National Budget 2025-26 Approved",
                    summary: "Parliament approves Rs. 1.8 trillion budget focusing on infrastructure and digital governance.",
                    content: "The federal budget for fiscal year 2025-26 has been approved with major allocations for digital infrastructure, smart city projects, and e-governance initiatives.",
                    date: "2025-01-14",
                    category: "federal",
                    priority: "high",
                    image: "https://via.placeholder.com/400x250?text=Budget+2025",
                    tags: ["Budget", "Infrastructure", "Policy"]
                },
                {
                    id: 3,
                    title: "Coordination Hub Launched",
                    summary: "New coordination platform bridges local and federal government communication gaps.",
                    content: "The Smart Nagarik platform now includes a coordination hub that enables real-time communication between local municipalities, provincial governments, and federal ministries.",
                    date: "2025-01-13",
                    category: "federal",
                    priority: "high",
                    image: "https://via.placeholder.com/400x250?text=Coordination+Hub",
                    tags: ["Coordination", "Platform", "Innovation"]
                }
            ],
            provincial: [
                {
                    id: 4,
                    title: "Bagmati Province Digital Services Expansion",
                    summary: "Provincial government expands digital services to all 13 districts.",
                    content: "Bagmati Pradesh has successfully expanded its digital service delivery to all districts, enabling citizens to access government services online.",
                    date: "2025-01-12",
                    category: "provincial",
                    priority: "medium",
                    image: "https://via.placeholder.com/400x250?text=Bagmati+Province",
                    tags: ["Provincial", "Services", "Expansion"]
                },
                {
                    id: 5,
                    title: "Gandaki Province Smart City Initiative",
                    summary: "Pokhara selected for smart city development under provincial initiative.",
                    content: "Gandaki Pradesh has selected Pokhara as the first smart city in the province, with plans for integrated digital infrastructure and citizen services.",
                    date: "2025-01-11",
                    category: "provincial",
                    priority: "medium",
                    image: "https://via.placeholder.com/400x250?text=Smart+City",
                    tags: ["Smart City", "Development", "Infrastructure"]
                }
            ],
            local: [
                {
                    id: 6,
                    title: "Kathmandu Metropolitan City - Online Permit System",
                    summary: "KMC launches online building permit and business registration system.",
                    content: "Kathmandu Metropolitan City has launched a fully digital permit system, reducing processing time from weeks to days.",
                    date: "2025-01-10",
                    category: "local",
                    priority: "medium",
                    image: "https://via.placeholder.com/400x250?text=KMC+Update",
                    tags: ["Local", "Permits", "Digital"]
                },
                {
                    id: 7,
                    title: "Lalitpur Municipality - Waste Management App",
                    summary: "New mobile app connects citizens with waste collection services.",
                    content: "Lalitpur Municipality has launched a mobile application that allows citizens to schedule waste collection and track service delivery in real-time.",
                    date: "2025-01-09",
                    category: "local",
                    priority: "low",
                    image: "https://via.placeholder.com/400x250?text=Waste+Management",
                    tags: ["Local", "App", "Environment"]
                },
                {
                    id: 8,
                    title: "Bhaktapur Municipality - Property Tax Online Payment",
                    summary: "Property tax can now be paid online through Smart Nagarik portal.",
                    content: "Bhaktapur Municipality has integrated property tax payment into the Smart Nagarik platform, enabling citizens to pay taxes online with instant receipt generation.",
                    date: "2025-01-08",
                    category: "local",
                    priority: "medium",
                    image: "https://via.placeholder.com/400x250?text=Tax+Payment",
                    tags: ["Local", "Tax", "Payment"]
                }
            ]
        };

        const servicesData = [
            { id: 1, name: "Digital Citizenship Card", category: "citizenship", icon: "fa-id-card", description: "Apply for and manage your digital citizenship card" },
            { id: 2, name: "Passport Application", category: "passport", icon: "fa-passport", description: "Apply for new passport or renew existing one" },
            { id: 3, name: "Birth Certificate", category: "documents", icon: "fa-certificate", description: "Apply for birth certificate online" },
            { id: 4, name: "Marriage Certificate", category: "documents", icon: "fa-heart", description: "Register marriage and get certificate" },
            { id: 5, name: "Death Certificate", category: "documents", icon: "fa-file-alt", description: "Apply for death certificate" },
            { id: 6, name: "Driving License", category: "licenses", icon: "fa-id-badge", description: "Apply for or renew driving license" },
            { id: 7, name: "Business Registration", category: "licenses", icon: "fa-briefcase", description: "Register your business online" },
            { id: 8, name: "Property Registration", category: "documents", icon: "fa-home", description: "Register property documents" },
            { id: 9, name: "Electricity Bill Payment", category: "payments", icon: "fa-bolt", description: "Pay electricity bills online" },
            { id: 10, name: "Water Bill Payment", category: "payments", icon: "fa-tint", description: "Pay water supply bills" },
            { id: 11, name: "Internet Bill Payment", category: "payments", icon: "fa-wifi", description: "Pay internet and telecom bills" },
            { id: 12, name: "Tax Payment", category: "payments", icon: "fa-file-invoice-dollar", description: "Pay income and property taxes" },
            { id: 13, name: "Vehicle Registration", category: "licenses", icon: "fa-car", description: "Register new vehicle or transfer ownership" },
            { id: 14, name: "Building Permit", category: "licenses", icon: "fa-building", description: "Apply for building construction permit" },
            { id: 15, name: "Health Insurance", category: "utilities", icon: "fa-heartbeat", description: "Apply for government health insurance" },
            { id: 16, name: "Social Security", category: "utilities", icon: "fa-shield-alt", description: "Register for social security benefits" },
            { id: 17, name: "Education Certificate Verification", category: "documents", icon: "fa-graduation-cap", description: "Verify educational certificates" },
            { id: 18, name: "Police Clearance", category: "documents", icon: "fa-user-shield", description: "Apply for police clearance certificate" },
            { id: 19, name: "Land Survey", category: "documents", icon: "fa-map", description: "Request land survey services" },
            { id: 20, name: "Grievance Filing", category: "utilities", icon: "fa-comment-alt", description: "File complaints and grievances" }
        ];

        // Initialize News Portal
        function initializeNewsPortal() {
            renderFeaturedNews();
            renderNewsGrid();
            renderTrendingNews();
            renderPolicyChanges();
            renderUpcomingEvents();
        }

        function renderFeaturedNews() {
            const featured = newsData.federal[0];
            const featuredEl = document.getElementById('featuredNews');
            if (featuredEl) {
                featuredEl.innerHTML = `
                    <div class="featured-image" style="background-image: url('${featured.image}');">
                        <div class="featured-badge">${featured.category.toUpperCase()}</div>
                    </div>
                    <div class="featured-content">
                        <div class="featured-meta">
                            <span><i class="fas fa-calendar"></i> ${formatDate(featured.date)}</span>
                            <span><i class="fas fa-tag"></i> ${featured.tags.join(', ')}</span>
                        </div>
                        <h2>${featured.title}</h2>
                        <p>${featured.summary}</p>
                        <button class="btn-primary" onclick="openNewsDetail(${featured.id})">Read More</button>
                    </div>
                `;
            }
        }

        function renderNewsGrid() {
            const gridEl = document.getElementById('newsGrid');
            if (!gridEl) return;
            
            const allNews = [...newsData.federal, ...newsData.provincial, ...newsData.local];
            gridEl.innerHTML = allNews.map(news => `
                <div class="news-card" data-category="${news.category}">
                    <div class="news-card-image" style="background-image: url('${news.image}');">
                        <span class="news-badge ${news.category}">${news.category}</span>
                    </div>
                    <div class="news-card-content">
                        <div class="news-meta">
                            <span><i class="fas fa-calendar"></i> ${formatDate(news.date)}</span>
                            <span class="priority ${news.priority}">${news.priority}</span>
                        </div>
                        <h3>${news.title}</h3>
                        <p>${news.summary}</p>
                        <div class="news-tags">
                            ${news.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                        <button class="btn-text" onclick="openNewsDetail(${news.id})">Read More <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>
            `).join('');
        }

        function renderTrendingNews() {
            const trendingEl = document.getElementById('trendingNews');
            if (!trendingEl) return;
            
            const trending = newsData.federal.slice(0, 5);
            trendingEl.innerHTML = trending.map((news, index) => `
                <div class="trending-item">
                    <span class="trend-number">${index + 1}</span>
                    <div>
                        <h4 onclick="openNewsDetail(${news.id})">${news.title}</h4>
                        <small>${formatDate(news.date)}</small>
                    </div>
                </div>
            `).join('');
        }

        function renderPolicyChanges() {
            const policyEl = document.getElementById('policyChanges');
            if (!policyEl) return;
            
            const policies = [
                { title: "Digital Service Act 2025", date: "2025-01-15", status: "Active" },
                { title: "Data Protection Regulation", date: "2025-01-10", status: "Draft" },
                { title: "E-Governance Framework", date: "2025-01-05", status: "Active" }
            ];
            
            policyEl.innerHTML = policies.map(policy => `
                <div class="policy-item">
                    <h4>${policy.title}</h4>
                    <div class="policy-meta">
                        <span>${formatDate(policy.date)}</span>
                        <span class="status ${policy.status.toLowerCase()}">${policy.status}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderUpcomingEvents() {
            const eventsEl = document.getElementById('upcomingEvents');
            if (!eventsEl) return;
            
            const events = [
                { title: "Digital Governance Summit", date: "2025-02-01", location: "Kathmandu" },
                { title: "Citizen Service Fair", date: "2025-02-15", location: "Pokhara" },
                { title: "E-Government Workshop", date: "2025-02-20", location: "Lalitpur" }
            ];
            
            eventsEl.innerHTML = events.map(event => `
                <div class="event-item">
                    <div class="event-date">
                        <span class="day">${new Date(event.date).getDate()}</span>
                        <span class="month">${new Date(event.date).toLocaleString('default', { month: 'short' })}</span>
                    </div>
                    <div class="event-details">
                        <h4>${event.title}</h4>
                        <p><i class="fas fa-map-marker-alt"></i> ${event.location}</p>
                    </div>
                </div>
            `).join('');
        }

        function filterNews(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const gridEl = document.getElementById('newsGrid');
            const cards = gridEl.querySelectorAll('.news-card');
            
            cards.forEach(card => {
                if (category === 'all' || card.dataset.category === category) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function openNewsDetail(newsId) {
            const allNews = [...newsData.federal, ...newsData.provincial, ...newsData.local];
            const news = allNews.find(n => n.id === newsId);
            if (news) {
                alert(`News Detail:\n\n${news.title}\n\n${news.content}\n\nDate: ${formatDate(news.date)}\nCategory: ${news.category}`);
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        // Services Functions
        function initializeServices() {
            renderServices();
        }

        function renderServices() {
            const gridEl = document.getElementById('servicesGrid');
            if (!gridEl) return;
            
            gridEl.innerHTML = servicesData.map(service => `
                <div class="service-card-item" data-category="${service.category}">
                    <div class="service-icon">
                        <i class="fas ${service.icon}"></i>
                    </div>
                    <h3>${service.name}</h3>
                    <p>${service.description}</p>
                    <button class="btn-primary" onclick="openService('${service.name}')">Access Service</button>
                </div>
            `).join('');
        }

        function filterServices() {
            const searchTerm = document.getElementById('serviceSearch')?.value.toLowerCase() || '';
            const cards = document.querySelectorAll('.service-card-item');
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }

        function filterByCategory(category) {
            document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            const cards = document.querySelectorAll('.service-card-item');
            cards.forEach(card => {
                if (category === 'all' || card.dataset.category === category) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function openService(serviceName) {
            showToast(`Opening ${serviceName}...`);
            // In real implementation, this would navigate to the service page
        }

        // Enhanced Dashboard Functions
        function enhanceDashboard() {
            updateDashboardStats();
            loadRecentActivity();
            loadImportantNotices();
            loadPopularServices();
        }

        function updateDashboardStats() {
            // Animate counters
            document.querySelectorAll('.counter').forEach(counter => {
                const target = parseInt(counter.dataset.target);
                const duration = 2000;
                const increment = target / (duration / 16);
                let current = 0;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        counter.textContent = target.toLocaleString();
                        clearInterval(timer);
                    } else {
                        counter.textContent = Math.floor(current).toLocaleString();
                    }
                }, 16);
            });
        }

        function loadRecentActivity() {
            const activityEl = document.getElementById('recentActivity');
            if (!activityEl) return;
            
            const activities = [
                { type: 'application', text: 'Passport application submitted', time: '2 hours ago', status: 'pending' },
                { type: 'document', text: 'Birth certificate approved', time: '1 day ago', status: 'completed' },
                { type: 'update', text: 'Profile information updated', time: '2 days ago', status: 'completed' },
                { type: 'news', text: 'Read federal government update', time: '3 days ago', status: 'completed' },
                { type: 'application', text: 'Driving license renewal in progress', time: '4 days ago', status: 'pending' }
            ];
            
            activityEl.innerHTML = activities.map(activity => `
                <div class="activity-item ${activity.status}">
                    <div class="activity-icon">
                        <i class="fas fa-${getActivityIcon(activity.type)}"></i>
                    </div>
                    <div class="activity-content">
                        <p>${activity.text}</p>
                        <small>${activity.time}</small>
                    </div>
                </div>
            `).join('');
        }

        function loadImportantNotices() {
            const noticesEl = document.getElementById('importantNotices');
            if (!noticesEl) return;
            
            const notices = [
                { title: 'Coordination Hub Now Live', date: '2025-01-15', priority: 'high' },
                { title: 'New Digital Services Available', date: '2025-01-14', priority: 'high' },
                { title: 'Federal-Local Coordination Updates', date: '2025-01-13', priority: 'medium' },
                { title: 'Government News Portal Launched', date: '2025-01-12', priority: 'medium' }
            ];
            
            noticesEl.innerHTML = notices.map(notice => `
                <div class="notice-item ${notice.priority}" onclick="showTab('news')" style="cursor: pointer;">
                    <div class="notice-icon">
                        <i class="fas fa-bullhorn"></i>
                    </div>
                    <div>
                        <h4>${notice.title}</h4>
                        <small>${formatDate(notice.date)}</small>
                    </div>
                </div>
            `).join('');
        }

        function loadPopularServices() {
            const servicesEl = document.getElementById('popularServices');
            if (!servicesEl) return;
            
            const popular = servicesData.slice(0, 6);
            servicesEl.innerHTML = popular.map(service => `
                <div class="service-shortcut" onclick="openService('${service.name}')">
                    <i class="fas ${service.icon}"></i>
                    <span>${service.name}</span>
                </div>
            `).join('');
        }

        function getActivityIcon(type) {
            const icons = {
                'application': 'file-alt',
                'document': 'file-check',
                'payment': 'credit-card',
                'update': 'edit',
                'news': 'newspaper'
            };
            return icons[type] || 'circle';
        }

        // Applications Management
        const applicationsData = [
            {
                id: 'APP-2025-001',
                service: 'Passport Application',
                status: 'pending',
                submittedDate: '2025-01-10',
                lastUpdate: '2025-01-12',
                description: 'New passport application for international travel',
                progress: 60
            },
            {
                id: 'APP-2025-002',
                service: 'Birth Certificate',
                status: 'approved',
                submittedDate: '2025-01-05',
                lastUpdate: '2025-01-08',
                description: 'Birth certificate application for child',
                progress: 100
            },
            {
                id: 'APP-2025-003',
                service: 'Driving License Renewal',
                status: 'pending',
                submittedDate: '2025-01-08',
                lastUpdate: '2025-01-09',
                description: 'Renewal of driving license',
                progress: 40
            },
            {
                id: 'APP-2024-045',
                service: 'Citizenship Card',
                status: 'completed',
                submittedDate: '2024-12-15',
                lastUpdate: '2024-12-28',
                description: 'Digital citizenship card application',
                progress: 100
            },
            {
                id: 'APP-2025-004',
                service: 'Property Registration',
                status: 'rejected',
                submittedDate: '2025-01-03',
                lastUpdate: '2025-01-07',
                description: 'Property registration application',
                progress: 0,
                rejectionReason: 'Missing required documents'
            }
        ];

        function initializeApplications() {
            renderApplications();
        }

        function renderApplications(filter = 'all') {
            const listEl = document.getElementById('applicationsList');
            if (!listEl) return;

            let filtered = applicationsData;
            if (filter !== 'all') {
                filtered = applicationsData.filter(app => app.status === filter);
            }

            if (filtered.length === 0) {
                listEl.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>No applications found</h3>
                        <p>You don't have any ${filter === 'all' ? '' : filter} applications yet.</p>
                        <button class="btn-primary" onclick="showTab('services')">Browse Services</button>
                    </div>
                `;
                return;
            }

            listEl.innerHTML = filtered.map(app => `
                <div class="application-card" data-status="${app.status}">
                    <div class="application-header">
                        <div class="application-id">
                            <i class="fas fa-hashtag"></i>
                            <strong>${app.id}</strong>
                        </div>
                        <span class="status-badge ${app.status}">${app.status.charAt(0).toUpperCase() + app.status.slice(1)}</span>
                    </div>
                    <div class="application-body">
                        <h3>${app.service}</h3>
                        <p>${app.description}</p>
                        <div class="application-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${app.progress}%"></div>
                            </div>
                            <span>${app.progress}% Complete</span>
                        </div>
                        ${app.rejectionReason ? `<div class="rejection-notice"><i class="fas fa-exclamation-triangle"></i> ${app.rejectionReason}</div>` : ''}
                    </div>
                    <div class="application-footer">
                        <div class="application-dates">
                            <span><i class="fas fa-calendar-plus"></i> Submitted: ${formatDate(app.submittedDate)}</span>
                            <span><i class="fas fa-calendar-check"></i> Updated: ${formatDate(app.lastUpdate)}</span>
                        </div>
                        <div class="application-actions">
                            <button class="btn-text" onclick="viewApplicationDetails('${app.id}')">View Details</button>
                            ${app.status === 'pending' ? `<button class="btn-text" onclick="trackApplication('${app.id}')">Track</button>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterApplications(status) {
            document.querySelectorAll('.applications-filter .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            renderApplications(status);
        }

        function viewApplicationDetails(appId) {
            const app = applicationsData.find(a => a.id === appId);
            if (app) {
                alert(`Application Details:\n\nID: ${app.id}\nService: ${app.service}\nStatus: ${app.status}\nProgress: ${app.progress}%\n\nSubmitted: ${formatDate(app.submittedDate)}\nLast Update: ${formatDate(app.lastUpdate)}`);
            }
        }

        function trackApplication(appId) {
            showToast(`Tracking application ${appId}...`);
            // In real implementation, this would show detailed tracking
        }

        // Enhanced AI Assistant
        function enhanceAIAssistant() {
            // Update AI context for coordination theme
            if (window.callGeminiAPI) {
                const originalCall = window.callGeminiAPI;
                window.callGeminiAPI = function(message) {
                    const enhancedMessage = `You are a helpful assistant for Smart Nagarik citizen portal. The platform focuses on coordination between local and federal government. Help citizens with government services, track applications, and explain coordination features. User question: ${message}`;
                    return originalCall(enhancedMessage);
                };
            }
        }

        // Ensure showTab function handles news tab
        const originalShowTab = window.showTab;
        window.showTab = function(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            const targetTab = document.getElementById(`${tabName}-tab`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            // Activate corresponding nav button
            const navBtn = Array.from(document.querySelectorAll('.nav-btn')).find(btn => 
                btn.getAttribute('onclick')?.includes(`showTab('${tabName}')`)
            );
            if (navBtn) {
                navBtn.classList.add('active');
            }
            
            // Initialize content if needed
            if (tabName === 'news' && document.getElementById('newsGrid') && !document.getElementById('newsGrid').innerHTML) {
                initializeNewsPortal();
            }
            if (tabName === 'services' && document.getElementById('servicesGrid') && !document.getElementById('servicesGrid').innerHTML) {
                initializeServices();
            }
            if (tabName === 'applications' && document.getElementById('applicationsList') && !document.getElementById('applicationsList').innerHTML) {
                initializeApplications();
            }
            if (tabName === 'dashboard') {
                enhanceDashboard();
            }
            
            // Call original if exists
            if (originalShowTab && typeof originalShowTab === 'function') {
                originalShowTab(tabName);
            }
        };

        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for app.js to load
            setTimeout(() => {
                initializeNewsPortal();
                initializeServices();
                initializeApplications();
                enhanceDashboard();
                enhanceAIAssistant();
            }, 500);
        });

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('successToast');
            const messageEl = document.getElementById('toastMessage');
            if (toast && messageEl) {
                messageEl.textContent = message;
                toast.classList.remove('hidden');
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }
        }
    </script>
    
    <style>
        /* News Portal Styles */
        .news-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            margin-top: 2rem;
        }

        .featured-news-card {
            background: var(--card-bg, #fff);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .featured-image {
            height: 300px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .featured-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--primary-red, #dc2626);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .featured-content {
            padding: 2rem;
        }

        .featured-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
            color: #666;
            font-size: 0.875rem;
        }

        .featured-content h2 {
            font-size: 1.75rem;
            margin-bottom: 1rem;
            color: var(--text-primary, #1a1a1a);
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .news-card {
            background: var(--card-bg, #fff);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .news-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .news-card-image {
            height: 180px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .news-badge {
            position: absolute;
            top: 0.75rem;
            left: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }

        .news-badge.federal { background: #dc2626; }
        .news-badge.provincial { background: #2563eb; }
        .news-badge.local { background: #10b981; }

        .news-card-content {
            padding: 1.5rem;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            color: #666;
        }

        .priority {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .priority.high { background: #fee2e2; color: #dc2626; }
        .priority.medium { background: #dbeafe; color: #2563eb; }
        .priority.low { background: #d1fae5; color: #10b981; }

        .news-card-content h3 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary, #1a1a1a);
        }

        .news-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .tag {
            background: #f3f4f6;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            color: #666;
        }

        .news-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .news-widget {
            background: var(--card-bg, #fff);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .news-widget h3 {
            font-size: 1.125rem;
            margin-bottom: 1rem;
            color: var(--text-primary, #1a1a1a);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .trending-item {
            display: flex;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e5e7eb;
            cursor: pointer;
        }

        .trending-item:last-child {
            border-bottom: none;
        }

        .trend-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue, #2563eb);
            min-width: 2rem;
        }

        .trending-item h4 {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
            color: var(--text-primary, #1a1a1a);
        }

        .policy-item, .event-item {
            padding: 0.75rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .policy-item:last-child, .event-item:last-child {
            border-bottom: none;
        }

        .policy-item h4 {
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .policy-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #666;
        }

        .status {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: 600;
        }

        .status.active { background: #d1fae5; color: #10b981; }
        .status.draft { background: #fef3c7; color: #f59e0b; }

        .event-item {
            display: flex;
            gap: 1rem;
        }

        .event-date {
            background: var(--primary-blue, #2563eb);
            color: white;
            padding: 0.5rem;
            border-radius: 0.5rem;
            text-align: center;
            min-width: 3rem;
        }

        .event-date .day {
            display: block;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .event-date .month {
            display: block;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        .event-details h4 {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .news-filter-tabs {
            display: flex;
            gap: 0.5rem;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: var(--primary-blue, #2563eb);
            color: white;
            border-color: var(--primary-blue, #2563eb);
        }

        /* Services Grid Styles */
        .services-category-tabs {
            display: flex;
            gap: 0.5rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .category-tab {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-tab.active {
            background: var(--primary-blue, #2563eb);
            color: white;
            border-color: var(--primary-blue, #2563eb);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .service-card-item {
            background: var(--card-bg, #fff);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .service-card-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .service-icon {
            width: 4rem;
            height: 4rem;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary-red, #dc2626), var(--primary-blue, #2563eb));
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .service-card-item h3 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary, #1a1a1a);
        }

        .service-card-item p {
            font-size: 0.875rem;
            color: #666;
            margin-bottom: 1rem;
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }

        @media (max-width: 1024px) {
            .news-container {
                grid-template-columns: 1fr;
            }
            
            .news-sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .news-grid {
                grid-template-columns: 1fr;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Applications Tab Styles */
        .applications-filter {
            display: flex;
            gap: 0.5rem;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .applications-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .application-card {
            background: var(--card-bg, #fff);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #e5e7eb;
            transition: all 0.3s;
        }

        .application-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .application-card[data-status="pending"] {
            border-left-color: #f59e0b;
        }

        .application-card[data-status="approved"] {
            border-left-color: #10b981;
        }

        .application-card[data-status="completed"] {
            border-left-color: #2563eb;
        }

        .application-card[data-status="rejected"] {
            border-left-color: #dc2626;
        }

        .application-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .application-id {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            font-size: 0.875rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: capitalize;
        }

        .status-badge.pending {
            background: #fef3c7;
            color: #f59e0b;
        }

        .status-badge.approved {
            background: #d1fae5;
            color: #10b981;
        }

        .status-badge.completed {
            background: #dbeafe;
            color: #2563eb;
        }

        .status-badge.rejected {
            background: #fee2e2;
            color: #dc2626;
        }

        .application-body h3 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary, #1a1a1a);
        }

        .application-body p {
            color: #666;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .application-progress {
            margin: 1rem 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-blue, #2563eb), var(--primary-red, #dc2626));
            transition: width 0.3s;
        }

        .application-progress span {
            font-size: 0.75rem;
            color: #666;
        }

        .rejection-notice {
            background: #fee2e2;
            color: #dc2626;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .application-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .application-dates {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            font-size: 0.75rem;
            color: #666;
        }

        .application-dates span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .application-actions {
            display: flex;
            gap: 1rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .empty-state i {
            font-size: 4rem;
            color: #d1d5db;
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--text-primary, #1a1a1a);
        }

        /* Coordination Card Styles */
        .coordination-summary {
            margin: 1rem 0;
        }

        .coordination-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .coordination-item:last-child {
            border-bottom: none;
        }

        .coordination-item span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            font-size: 0.875rem;
        }

        .coordination-item strong {
            font-size: 1.25rem;
            color: var(--text-primary, #1a1a1a);
        }

        /* Orange stat card */
        .stat-card.orange {
            background: linear-gradient(135deg, #f97316, #fb923c);
        }

        @media (max-width: 768px) {
            .application-footer {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .application-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</body>
</html>